<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Micro:bit BLE Test</title>
</head>
<body>
  <h2>Micro:bit BLE 扫描测试</h2>
  <button id="connectBtn">扫描并连接 micro:bit</button>
  <p id="status">状态：等待操作...</p>

  <script>
    const btn = document.getElementById('connectBtn');
    const status = document.getElementById('status');

    btn.addEventListener('click', async () => {
      status.textContent = "状态：请求扫描设备...";
      try {
        const device = await navigator.bluetooth.requestDevice({
          filters: [{ services: ['6e400001-b5a3-f393-e0a9-e50e24dcca9e'] }] // micro:bit UART 服务
        });

        status.textContent = `状态：找到设备 ${device.name}，正在连接...`;

        const server = await device.gatt.connect();
        status.textContent = `状态：已连接 ${device.name}!`;

      } catch(err) {
        console.error(err);
        status.textContent = `连接失败：${err.message}`;
      }
    });
  </script>
</body>
</html>
